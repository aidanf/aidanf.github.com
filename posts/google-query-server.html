<!doctype html>
<html><!-- InstanceBegin template="/Templates/page-full-width.dwt" codeOutsideHTMLIsLocked="false" -->

<head>


    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" >
    <meta name="description" content="Aidan Finn's Website">
    <meta name="keywords" content="swift, clojure, ios, screencasts, book, python, ruby, machine learning, sligo">
    <meta name="author" content="Aidan Finn">

    <!-- InstanceBeginEditable name="doctitle" -->
    <title>Google Query Server</title>
    <!-- InstanceEndEditable -->

    <!-- FAV and TOUCH ICONS -->
    <link rel="shortcut icon" href="/favicon.ico">

    <!-- FONTS -->
    <link href='http://fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic' rel='stylesheet' type='text/css'>
    <link href='http://fonts.googleapis.com/css?family=UnifrakturMaguntia' rel='stylesheet' type='text/css'>
    <link href='http://fonts.googleapis.com/css?family=Coustard' rel='stylesheet' type='text/css'>

    <!--[if lte IE 9]>
        <script src="/js/html5shiv.js"></script>
        <script src="/js/selectivizr-min.js"></script>
    <![endif]-->

    <!-- STYLES -->
    <link rel="stylesheet" type="text/css" media="print" href="/css/print.css">
    <link rel="stylesheet" type="text/css" href="/css/grid.css">
    <link rel="stylesheet" type="text/css" href="/css/style.css">
    <link rel="stylesheet" type="text/css" href="/css/normalize.css">
    <link rel="stylesheet" type="text/css" href="/css/font-awesome.css">
    <link rel="stylesheet" type="text/css" href="/css/uniform.default.css">
    <link rel="stylesheet" type="text/css" href="/css/main.css">
    <link rel="stylesheet" type="text/css" href="/css/flexslider.css">

    <!-- SCRIPTS -->
    <!-- Grab Google CDN's jQuery, with a protocol relative URL; fall back to local if offline -->
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js"></script>
    <script>window.jQuery || document.write('<script src="/js/jquery-1.8.3.min.js"><\/script>')</script>


    <!-- InstanceBeginEditable name="head" -->
	<!-- InstanceEndEditable -->

        
</head>

<body>

    <!-- #PAGE -->
    <div id="page" class="hfeed site">

      

<!-- .site-header -->
<header class="site-header wrapper" role="banner">

    <!-- .row -->
    <div class="row">

        <!-- .site-title -->
        <hgroup>
            <h1 class="site-title"><a href="/" title="/aidanf/" rel="home">/aidanf/</a></h1>
            <h2 class="site-description">musings of a curious coder</h2>
        </hgroup>
        <!-- .site-title -->

        <!-- #site-navigation -->
        <nav id="site-navigation" class="main-navigation" role="navigation">
            <ul>
                <li ><a href="/">Blog</a></li>
                <li ><a href="/learn-swift">Learn Swift</a></li>
                <li ><a href="/about">About</a></li>
            </ul>
        </nav>
        <!-- #site-navigation -->

    </div>
    <!-- .row -->
</header>
<!-- .site-header -->

      <!-- #main -->
      <section id="main" class="middle wrapper">
        <div class="row row-fluid">





                <!-- #primary -->
                <div id="primary" class="site-content">

                    <!-- #content -->
                    <div id="content" role="main">
                      <!-- InstanceBeginEditable name="Middle-Content" -->

<!-- .blog-single -->
<div class="blog-single readable-content">


    <!-- .hentry -->
    <article class="post type-post format-standard hentry">


        <!-- .entry-header -->
        <header class="entry-header">
            <h1 class="entry-title">Google Query Server</h1>
        </header>
        <!-- .entry-header -->

        <!-- .entry-meta -->
        <div class="entry-meta">
            posted
            on <a href="#" title="11:15 pm" rel="bookmark">
            <time class="entry-date" datetime="2005-05-04T12:45:43+01:00">May 4, 2005
            </time>
        </a>

            <!-- .share-links -->
            <div class="share-links">
                <a>SHARE</a>

                <!-- .share-wrap -->
                <div class="share-wrap">

                    <!-- .facebook-wrap -->
                    <div class="facebook-wrap">

                        <div id="fb-root"></div>
                        <script>(function (d, s, id) {
                            var js, fjs = d.getElementsByTagName(s)[0];
                            if (d.getElementById(id)) return;
                            js = d.createElement(s);
                            js.id = id;
                            js.src = "//connect.facebook.net/en_US/all.js#xfbml=1";
                            fjs.parentNode.insertBefore(js, fjs);
                        }(document, 'script', 'facebook-jssdk'));</script>
                        <div class="fb-like" data-send="false" data-layout="button_count" data-width="400"
                             data-show-faces="false" data-colorscheme="light" data-action="like"></div>

                    </div>
                    <!-- .facebook-wrap -->

                    <!-- .twitter-wrap -->
                    <div class="twitter-wrap">
                        <a href="https://twitter.com/share" class="twitter-share-button">Tweet</a>
                        <script>!function (d, s, id) {
                            var js, fjs = d.getElementsByTagName(s)[0];
                            if (!d.getElementById(id)) {
                                js = d.createElement(s);
                                js.id = id;
                                js.src = "//platform.twitter.com/widgets.js";
                                fjs.parentNode.insertBefore(js, fjs);
                            }
                        }(document, "script", "twitter-wjs");</script>
                    </div>
                    <!-- .twitter-wrap -->

                    <!-- .google-wrap -->
                    <div class="google-wrap">
                        <!-- Place this tag where you want the +1 button to render. -->
                        <div class="g-plusone" data-size="medium"></div>

                        <!-- Place this tag after the last +1 button tag. -->
                        <script type="text/javascript">
                            (function () {
                                var po = document.createElement('script');
                                po.type = 'text/javascript';
                                po.async = true;
                                po.src = 'https://apis.google.com/js/plusone.js';
                                var s = document.getElementsByTagName('script')[0];
                                s.parentNode.insertBefore(po, s);
                            })();
                        </script>
                    </div>
                    <!-- .google-wrap -->

                    <!-- .pinterest-wrap -->
                    <div class="pinterest-wrap">
                        <a href="http://pinterest.com/pin/create/button/?url=http%3A%2F%2Fthemes.pixelwars.org%2Fread%2Fblog-single.html&media=http%3A%2F%2Fthemes.pixelwars.org%2Fread%2Fimages%2Fblog%2Fblog-01.jpg&description=Adaptive%20Vs.%20Responsive%20Layouts%20And%20Optimal%20Form%20Field%20Labels"
                           class="pin-it-button" count-layout="horizontal"><img
                                src="//assets.pinterest.com/images/PinExt.png" alt="Pin It" title="Pin It"/></a>
                        <script type="text/javascript" src="//assets.pinterest.com/js/pinit.js"></script>
                    </div>
                    <!-- .pinterest-wrap -->

                </div>
                <!-- .share-wrap -->


            </div>
            <!-- .share-links -->


        </div>
        <!-- .entry-meta -->


        <!-- .featured-image -->
        
        <!-- .featured-image -->


        <!-- .entry-content -->
        <div class="entry-content">
            <p><a href="https://github.com/aidanf/gqserv">Source on github</a></p>

<p>gqserv - a centralised mechanism for querying google</p>
<p><strong>1 Introduction</strong></p>
<p>gqserv allows the centralised pooling of google queries<br />
and caching of retrieved results. Queries are submitted<br />
to gqserv and queued. They are retrieved from google(in<br />
xml format) during off-peak hours and cached. Cached<br />
queries are then available to users. Interaction with<br />
gqserv is through a socket interface. There are also<br />
command line tools for accessing gqserv: gqclient,<br />
gqsubmit and gqretrieve. </p>
<p><strong>2 The socket interface</strong></p>
<p>gqserv operates as a socket server. To use the server<br />
directly, the client program must open a socket<br />
connection to the appropriate port. The client then<br />
sends a command to the server. The server executes the<br />
command and returns a status message. The first<br />
character of the returned message indicated success(1)<br />
or failure(0) of the command.</p>
<p>Commands sent to the server are required to be in<br />
netstring format http://cr.yp.to/proto/netstrings.txt  .</p>
<p>The format of a netstring is:</p>
<p><code>Length:STRING,</code></p>
<p>Length is the decimal representation in ascii of the<br />
number of characters in the string. A colon follows the<br />
length, then comes the actual string and then a<br />
terminating comma for simple error check. So the string </p>
<p><code>"hello world!"</code></p>
<p>would actually be transmitted as</p>
<p><code>"12:hello world!,"</code></p>
<p>Strings sent to gqserv should be in encoded in<br />
netstring format before transmission and strings<br />
received should be decoded from netstring format.</p>
<p><strong>3 Available Commands</strong></p>
<p>Commands sent to the server are of the format</p>
<p><code>command [keyword1 keyword2 keyword3 ...] [param: parameter1 param: parameter2 ...]</code></p>
<p>command is the actual command to be performed by the<br />
server. A sequence of keywords makes up the query.<br />
Optional parameters can be listed after the query. The<br />
parameters must come after the query.</p>
<p>The following commands are recognised by the server:</p>
<ul>
<li>add_query</li>
<li>add_query_force</li>
<li>retrieve_query</li>
<li>queue_stat</li>
<li>queue_contents</li>
</ul>
<p>add_query : Adds a query to the gqserv queue. E.g.</p>
<p><code>add_query hello world param:num=50</code></p>
<p>This adds the query 'hello world' to the queue with the<br />
google parameter num set to 50 to return 50 results.<br />
When the query is retrieved it is stored in the cache.</p>
<p>retrieve_query : Retrieves a query from the cache if it exists. E.g.</p>
<p><code>retrieve_query hello world param: num=50</code></p>
<p>retrieves the above query from the cache. Do not try to<br />
access the cache directly.</p>
<p>add_query_force : Same as add_query except that it adds a query to the<br />
gqserv queue even if it is already in the cache.</p>
<p>queue_stat : Returns some gqserv queue statistics</p>
<p>queue_contents : Returns the currents of the gqserv queue</p>
<p><strong>4 gqclient</strong></p>
<p>gqclient is an tool for interactively sending commands<br />
to gqserv. It has two optional arguments.</p>
<p><code>gqclient [-h host] [-p port]</code></p>
<p>Here is a sample gqclient session:<br />
<code><br />
[aidan@smi gqserv]$ ./gqclient.py</p>
<p>Host: 127.0.0.1</p>
<p>port: 8081 </p>
<p>Send: asdas asda </p>
<p>Returned: 0 UNKNOWN COMMAND:asdas</p>
<p>Send: queue_stat </p>
<p>Returned: 0 items in queue </p>
<p>Send: add_query hello world </p>
<p>Returned: 1 ADDED: hello_world_ </p>
<p>Send: add_query the hellacopters param: num=50 </p>
<p>Returned: 1 ADDED: the_hellacopters_param:_num=50_ </p>
<p>Send: retrieve_query hello world </p>
<p>Returned: 0 QUERY NOT IN CACHE hello_world_ </p>
<p>Send: queue_contents </p>
<p>Returned: ['hello_world_', 'the_hellacopters_param:_num=50_']<br />
</code></p>
<p>The distribution contains examples of connecting and sending commands to the server in python and java.</p>
<p><strong>5 gqsubmit and gqretrieve</strong></p>
<p>These are command line tools for submitting and<br />
retrieving multiple queries.</p>
<p><code>gqsubmit [-h hostname] [-p port] filename</code></p>
<p><code>gqretrieve [-h hostname] [-p port] filename</code></p>
<p>The input file should contain one query per line. Run<br />
gqsubmit to submit all the queries in the file to<br />
gqserv. Running gqretrieve the next day will retrieve<br />
all the queries and save each one in an individual file<br />
in the current directory. The filename will be the<br />
query with spaces replaced by underscores. Here is an<br />
example query file:</p>
<p><code>the hellacopters<br />
monster magnet<br />
macos vs linux param: num=50<br />
hello world :param num=20 param: start=10<br />
liverpool f.c.<br />
i hate man united</code></p>

        </div>
        <!-- .entry-content -->


    </article>
    <!-- .hentry -->

    <!-- .nav-single -->
    <nav class="nav-single row-fluid">
        
        <div class="nav-previous span6">
            <h4>PREVIOUS POST</h4>
            <a href="/posts/knight" rel="prev"><span class="meta-nav">←</span> Knight</a>
        </div>
        

        
        <div class="nav-next span6">
            <h4>NEXT POST</h4>
            <a href="/posts/bte-body-text-extraction" rel="next">BTE: Body Text Extraction <span class="meta-nav">→</span></a>
        </div>
        

    </nav>
    <!-- .nav-single -->

</div>
<!-- .blog-single -->


<!-- InstanceEndEditable -->
                    </div>
                    <!-- #content -->

                </div>
                <!-- #primary -->





         </div>
      </section>
      <!-- #main -->





          <!-- .site-footer -->
      <footer class="site-footer wrapper" role="contentinfo">
        <!-- .row -->
        <div class="row">


          <!-- #supplementary -->
          <div id="supplementary" class="row-fluid">


            <!-- .widget-area -->
            <!--<div class="widget-area span3" role="complementary">

              <aside class="widget widget_text">
                <h3 class="widget-title">About Read</h3>
                <div class="textwidget">Read is a minimalistic wordpress theme focused on readability. This is a just text widget with some dummy content. This is a just text widget with some dummy content. This is a just text widget with some dummy content.</div>
              </aside>

            </div>-->
            <!-- .widget-area -->


            <!-- .widget-area -->
            <!--<div class="widget-area span3" role="complementary">

              <aside class="widget widget_recent_entries">
                  <h3 class="widget-title">Recent Posts</h3>
                  <ul>
                    <li><a href="#" title="Thinking About Responsive Design">Thinking About Responsive Design</a></li>
                    <li><a href="#" title="Adaptive Vs. Responsive Layouts And Optimal Form Field Labels">Adaptive Vs. Responsive Layouts And Optimal Form Field Labels</a></li>
                    <li><a href="#" title="Hello world!">Hello world!</a></li>
                  </ul>
                </aside>

            </div>-->
            <!-- .widget-area -->

            <!-- .widget-area -->
            <!--<div class="widget-area span3" role="complementary">

              <aside class="widget widget-instagram">
                  <h3 class="widget-title">Photos on Instagram</h3>
                  <div class="instagram"></div>
                  <script src="../js/instagram.js"></script>
                </aside>

            </div>-->
            <!-- .widget-area -->

            <!-- .widget-area -->
            <!--<div class="widget-area span3" role="complementary">

              <aside class="widget widget_categories">
                  <h3 class="widget-title">Categories</h3>
                  <ul>
                    <li><a href="#" title="View all posts filed under Uncategorized">Web Design</a></li>
                    <li><a href="#" title="View all posts filed under Uncategorized">Javascript</a></li>
                    <li><a href="#" title="View all posts filed under Uncategorized">Typography</a></li>
                    <li><a href="#" title="View all posts filed under Uncategorized">Freebies</a></li>
                  </ul>
                </aside>

            </div>-->
            <!-- .widget-area -->


          </div>
          <!-- #supplementary -->


          <!-- .site-info -->
          <div class="site-info">(c) Aidan Finn</div>
          <!-- .site-info -->

        </div>
        <!-- .row -->
      </footer>
      <!-- .site-footer -->

    </div>
    <!-- #PAGE -->




    <!-- SCRIPTS -->
    <script src="/js/detectmobilebrowser.js"></script>
    <script src="/js/modernizr.js"></script>
    <script src="/js/jquery.imagesloaded.min.js"></script>
    <script src="/js/jquery.fitvids.js"></script>
    <script src="/js/jquery.uniform.min.js"></script>

    <!-- InstanceBeginEditable name="body-end" -->
    <script src="/js/jquery.validate.min.js"></script>
	<!-- InstanceEndEditable -->

    <script src="/js/main.js"></script>


<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-539512-1', 'auto');
  ga('send', 'pageview');
</script>

</body>
<!-- InstanceEnd --></html>
